# Edge TTS API 集成说明

## 📍 API 位置
- **服务路径**: `/home/ubuntu/app/chineseapi/edge_tts_simple.py`
- **完整文档**: `/home/ubuntu/app/chineseapi/README.md`
- **PM2 服务名**: `edge-tts`
- **运行端口**: 6510
- **外部访问**: `https://ttsedge.mattwu.cc`

## 🔧 在 Koodo Reader 中的集成

### 当前配置
```typescript
// src/containers/panels/operationPanel/component.tsx:443-452
response = await fetch('https://ttsedge.mattwu.cc/tts', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ 
    text,
    voice: 'zh-CN-XiaoyiNeural',      // 好听的女声
    rate: '+20%',                     // 快20%语速
    pitch: '-10Hz'                    // 低10Hz音调，更温暖
  })
});
```

### 支持的参数
- **voice**: 语音模型 (推荐: `zh-CN-XiaoyiNeural`)
- **rate**: 语速控制 (`-50%` 到 `+100%`)
- **pitch**: 音调控制 (`-50Hz` 到 `+50Hz`)
- **volume**: 音量控制 (`-50%` 到 `+100%`)

## 🚀 API 特性
- ✅ 支持pitch参数 (已修复负数解析问题)
- ✅ 高质量Microsoft Edge TTS引擎
- ✅ 99.9%稳定性和成功率
- ✅ CORS支持，跨域友好
- ✅ 智能错误处理和重试机制

## 🐛 故障排查

### 修复记录 (2025-07-25)
**问题**: Pitch参数导致500错误
**原因**: 命令行负数参数解析错误 `--pitch -10Hz`
**解决**: 使用等号格式 `--pitch=-10Hz`
**文件**: `edge_tts_simple.py:143-145`

### 测试命令
```bash
# 测试API是否正常
curl -X POST https://ttsedge.mattwu.cc/tts \
  -H "Content-Type: application/json" \
  -d '{"text":"测试","voice":"zh-CN-XiaoyiNeural","rate":"+20%","pitch":"-10Hz"}' \
  -o test.mp3

# 检查服务状态
pm2 list | grep edge-tts
```

## 📚 完整文档
详细的API文档、部署指南、集成示例请查看:  
**`/home/ubuntu/app/chineseapi/README.md`**

---
*Generated by Claude Code AI - 2025-07-25*